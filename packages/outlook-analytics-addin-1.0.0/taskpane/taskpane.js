(()=>{"use strict";var e={56:(e,n,t)=>{e.exports=function(e){var n=t.nc;n&&e.setAttribute("nonce",n)}},72:e=>{var n=[];function t(e){for(var t=-1,o=0;o<n.length;o++)if(n[o].identifier===e){t=o;break}return t}function o(e,o){for(var a={},s=[],i=0;i<e.length;i++){var l=e[i],c=o.base?l[0]+o.base:l[0],d=a[c]||0,p="".concat(c," ").concat(d);a[c]=d+1;var u=t(p),g={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==u)n[u].references++,n[u].updater(g);else{var f=r(g,o);o.byIndex=i,n.splice(i,0,{identifier:p,updater:f,references:1})}s.push(p)}return s}function r(e,n){var t=n.domAPI(n);return t.update(e),function(n){if(n){if(n.css===e.css&&n.media===e.media&&n.sourceMap===e.sourceMap&&n.supports===e.supports&&n.layer===e.layer)return;t.update(e=n)}else t.remove()}}e.exports=function(e,r){var a=o(e=e||[],r=r||{});return function(e){e=e||[];for(var s=0;s<a.length;s++){var i=t(a[s]);n[i].references--}for(var l=o(e,r),c=0;c<a.length;c++){var d=t(a[c]);0===n[d].references&&(n[d].updater(),n.splice(d,1))}a=l}}},113:e=>{e.exports=function(e,n){if(n.styleSheet)n.styleSheet.cssText=e;else{for(;n.firstChild;)n.removeChild(n.firstChild);n.appendChild(document.createTextNode(e))}}},314:e=>{e.exports=function(e){var n=[];return n.toString=function(){return this.map(function(n){var t="",o=void 0!==n[5];return n[4]&&(t+="@supports (".concat(n[4],") {")),n[2]&&(t+="@media ".concat(n[2]," {")),o&&(t+="@layer".concat(n[5].length>0?" ".concat(n[5]):""," {")),t+=e(n),o&&(t+="}"),n[2]&&(t+="}"),n[4]&&(t+="}"),t}).join("")},n.i=function(e,t,o,r,a){"string"==typeof e&&(e=[[null,e,void 0]]);var s={};if(o)for(var i=0;i<this.length;i++){var l=this[i][0];null!=l&&(s[l]=!0)}for(var c=0;c<e.length;c++){var d=[].concat(e[c]);o&&s[d[0]]||(void 0!==a&&(void 0===d[5]||(d[1]="@layer".concat(d[5].length>0?" ".concat(d[5]):""," {").concat(d[1],"}")),d[5]=a),t&&(d[2]?(d[1]="@media ".concat(d[2]," {").concat(d[1],"}"),d[2]=t):d[2]=t),r&&(d[4]?(d[1]="@supports (".concat(d[4],") {").concat(d[1],"}"),d[4]=r):d[4]="".concat(r)),n.push(d))}},n}},540:e=>{e.exports=function(e){var n=document.createElement("style");return e.setAttributes(n,e.attributes),e.insert(n,e.options),n}},601:e=>{e.exports=function(e){return e[1]}},659:e=>{var n={};e.exports=function(e,t){var o=function(e){if(void 0===n[e]){var t=document.querySelector(e);if(window.HTMLIFrameElement&&t instanceof window.HTMLIFrameElement)try{t=t.contentDocument.head}catch(e){t=null}n[e]=t}return n[e]}(e);if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(t)}},825:e=>{e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var n=e.insertStyleElement(e);return{update:function(t){!function(e,n,t){var o="";t.supports&&(o+="@supports (".concat(t.supports,") {")),t.media&&(o+="@media ".concat(t.media," {"));var r=void 0!==t.layer;r&&(o+="@layer".concat(t.layer.length>0?" ".concat(t.layer):""," {")),o+=t.css,r&&(o+="}"),t.media&&(o+="}"),t.supports&&(o+="}");var a=t.sourceMap;a&&"undefined"!=typeof btoa&&(o+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(a))))," */")),n.styleTagTransform(o,e,n.options)}(n,e,t)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)}}}},942:(e,n,t)=>{t.d(n,{A:()=>i});var o=t(601),r=t.n(o),a=t(314),s=t.n(a)()(r());s.push([e.id,"* {\n    box-sizing: border-box;\n}\n\nhtml, body {\n    width: 100%;\n    height: 100%;\n    margin: 0;\n    padding: 0;\n    font-family: 'Segoe UI', -apple-system, BlinkMacSystemFont, 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', sans-serif;\n    -webkit-font-smoothing: antialiased;\n    -moz-osx-font-smoothing: grayscale;\n}\n\n#content-header {\n    background: linear-gradient(135deg, #0078d4 0%, #106ebe 100%);\n    color: white;\n    padding: 24px 20px;\n    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n    position: sticky;\n    top: 0;\n    z-index: 100;\n}\n\n#content-header h1 {\n    margin: 0;\n    font-size: 24px;\n    font-weight: 600;\n    display: flex;\n    align-items: center;\n    gap: 10px;\n}\n\n#content-header h1::before {\n    content: 'üìä';\n    font-size: 28px;\n}\n\n#content-main {\n    padding: 24px 20px;\n    overflow-y: auto;\n    background: #faf9f8;\n    min-height: calc(100vh - 80px);\n}\n\n.date-range-selector {\n    margin: 24px 0;\n    padding: 20px;\n    background: white;\n    border-radius: 8px;\n    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);\n    border: 1px solid #edebe9;\n    transition: box-shadow 0.2s ease;\n}\n\n.date-range-selector:hover {\n    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);\n}\n\n.date-range-selector label {\n    display: block;\n    margin: 12px 0 6px 0;\n    font-weight: 600;\n    color: #323130;\n    font-size: 14px;\n}\n\n.date-range-selector input[type=\"date\"] {\n    padding: 10px 12px;\n    margin-right: 15px;\n    margin-bottom: 12px;\n    border: 2px solid #edebe9;\n    border-radius: 6px;\n    font-size: 14px;\n    transition: all 0.2s ease;\n    background: white;\n    color: #323130;\n}\n\n.date-range-selector input[type=\"date\"]:focus {\n    outline: none;\n    border-color: #0078d4;\n    box-shadow: 0 0 0 3px rgba(0, 120, 212, 0.1);\n}\n\n.ms-Button {\n    background-color: #0078d4;\n    color: white;\n    border: none;\n    padding: 12px 24px;\n    border-radius: 6px;\n    cursor: pointer;\n    font-size: 14px;\n    font-weight: 600;\n    margin: 8px 4px;\n    transition: all 0.2s ease;\n    box-shadow: 0 2px 4px rgba(0, 120, 212, 0.2);\n    display: inline-flex;\n    align-items: center;\n    gap: 8px;\n}\n\n.ms-Button:hover {\n    background-color: #106ebe;\n    transform: translateY(-1px);\n    box-shadow: 0 4px 8px rgba(0, 120, 212, 0.3);\n}\n\n.ms-Button:active {\n    transform: translateY(0);\n    box-shadow: 0 1px 2px rgba(0, 120, 212, 0.2);\n}\n\n.ms-Button:focus {\n    outline: none;\n    box-shadow: 0 0 0 3px rgba(0, 120, 212, 0.3);\n}\n\n.ms-Button--primary {\n    background-color: #0078d4;\n}\n\n.ms-Button-label {\n    display: flex;\n    align-items: center;\n    gap: 6px;\n}\n\n.color-filters {\n    margin: 24px 0;\n    padding: 20px;\n    background: white;\n    border-radius: 8px;\n    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);\n    border: 1px solid #edebe9;\n    display: flex;\n    flex-wrap: wrap;\n    gap: 20px;\n    align-items: center;\n}\n\n.color-filters label {\n    display: inline-flex;\n    align-items: center;\n    gap: 8px;\n    cursor: pointer;\n    padding: 8px 12px;\n    border-radius: 6px;\n    transition: all 0.2s ease;\n    user-select: none;\n}\n\n.color-filters label:hover {\n    background: #f3f2f1;\n}\n\n.color-filters input[type=\"checkbox\"] {\n    width: 18px;\n    height: 18px;\n    cursor: pointer;\n    accent-color: #0078d4;\n}\n\n.color-indicator {\n    display: inline-block;\n    width: 20px;\n    height: 20px;\n    border-radius: 50%;\n    vertical-align: middle;\n    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);\n    border: 2px solid white;\n}\n\n.color-indicator.red {\n    background-color: #d13438;\n}\n\n.color-indicator.green {\n    background-color: #107c10;\n}\n\n.color-indicator.blue {\n    background-color: #0078d4;\n}\n\n.statistics-panel {\n    margin: 24px 0;\n    padding: 24px;\n    background: white;\n    border: 1px solid #edebe9;\n    border-radius: 8px;\n    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);\n    animation: fadeIn 0.3s ease;\n}\n\n@keyframes fadeIn {\n    from {\n        opacity: 0;\n        transform: translateY(10px);\n    }\n    to {\n        opacity: 1;\n        transform: translateY(0);\n    }\n}\n\n.statistics-panel h2 {\n    margin-top: 0;\n    margin-bottom: 20px;\n    color: #323130;\n    font-size: 20px;\n    font-weight: 600;\n    display: flex;\n    align-items: center;\n    gap: 10px;\n}\n\n.statistics-panel h2::before {\n    content: 'üìà';\n    font-size: 24px;\n}\n\n.stat-item {\n    margin: 16px 0;\n    padding: 16px;\n    background: #faf9f8;\n    border-left: 4px solid #0078d4;\n    border-radius: 6px;\n    transition: all 0.2s ease;\n}\n\n.stat-item:hover {\n    background: #f3f2f1;\n    transform: translateX(4px);\n}\n\n.stat-item strong {\n    color: #0078d4;\n    font-size: 15px;\n}\n\n.stat-item .stat-header span {\n    font-size: 14px;\n    color: #605e5c;\n    font-weight: 500;\n}\n\n.meetings-list {\n    margin: 20px 0;\n}\n\n.meetings-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 20px;\n    flex-wrap: wrap;\n    gap: 12px;\n    padding-bottom: 16px;\n    border-bottom: 2px solid #edebe9;\n}\n\n.meetings-header h2 {\n    color: #323130;\n    margin: 0;\n    font-size: 20px;\n    font-weight: 600;\n    display: flex;\n    align-items: center;\n    gap: 10px;\n}\n\n.meetings-header h2::before {\n    content: 'üìã';\n    font-size: 24px;\n}\n\n.meetings-controls {\n    display: flex;\n    align-items: center;\n    gap: 12px;\n    flex-wrap: wrap;\n}\n\n.meetings-controls label {\n    font-size: 14px;\n    font-weight: 600;\n    color: #323130;\n}\n\n.sort-select {\n    padding: 8px 12px;\n    border: 2px solid #edebe9;\n    border-radius: 6px;\n    font-size: 14px;\n    background: white;\n    color: #323130;\n    cursor: pointer;\n    transition: all 0.2s ease;\n    font-weight: 500;\n    min-width: 180px;\n}\n\n.sort-select:hover {\n    border-color: #0078d4;\n    background: #f3f2f1;\n}\n\n.sort-select:focus {\n    outline: none;\n    border-color: #0078d4;\n    box-shadow: 0 0 0 3px rgba(0, 120, 212, 0.1);\n}\n\n.meetings-count {\n    color: #605e5c;\n    font-size: 14px;\n    font-weight: 600;\n    padding: 6px 12px;\n    background: #f3f2f1;\n    border-radius: 16px;\n    white-space: nowrap;\n}\n\n.no-meetings {\n    text-align: center;\n    padding: 60px 40px;\n    color: #605e5c;\n    background: white;\n    border-radius: 8px;\n    border: 2px dashed #edebe9;\n    margin: 24px 0;\n}\n\n.no-meetings::before {\n    content: 'üìÖ';\n    font-size: 48px;\n    display: block;\n    margin-bottom: 16px;\n    opacity: 0.5;\n}\n\n.no-meetings p {\n    margin: 0;\n    font-size: 16px;\n    font-weight: 500;\n}\n\n.meeting-item {\n    padding: 18px;\n    margin: 12px 0;\n    border-radius: 8px;\n    border-left: 5px solid #8a8886;\n    background: white;\n    border: 1px solid #edebe9;\n    transition: all 0.2s ease;\n    cursor: pointer;\n    position: relative;\n    overflow: hidden;\n}\n\n.meeting-item::before {\n    content: '';\n    position: absolute;\n    left: 0;\n    top: 0;\n    width: 5px;\n    height: 100%;\n    transition: width 0.3s ease;\n}\n\n.meeting-item:hover {\n    transform: translateX(4px);\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);\n    border-color: transparent;\n}\n\n.meeting-item:hover::before {\n    width: 8px;\n}\n\n.meeting-item.red {\n    border-left-color: #d13438;\n    background: linear-gradient(90deg, #fff4f4 0%, #ffffff 100%);\n}\n\n.meeting-item.red::before {\n    background: #d13438;\n}\n\n.meeting-item.green {\n    border-left-color: #107c10;\n    background: linear-gradient(90deg, #f4fff4 0%, #ffffff 100%);\n}\n\n.meeting-item.green::before {\n    background: #107c10;\n}\n\n.meeting-item.blue {\n    border-left-color: #0078d4;\n    background: linear-gradient(90deg, #f4f8ff 0%, #ffffff 100%);\n}\n\n.meeting-item.blue::before {\n    background: #0078d4;\n}\n\n.meeting-item .meeting-subject {\n    font-weight: 600;\n    font-size: 16px;\n    color: #323130;\n    margin-bottom: 8px;\n    line-height: 1.4;\n}\n\n.meeting-item .meeting-details {\n    font-size: 14px;\n    color: #605e5c;\n    display: flex;\n    flex-wrap: wrap;\n    gap: 12px;\n    align-items: center;\n    margin-bottom: 8px;\n}\n\n.meeting-item .meeting-details::before {\n    content: 'üìÖ';\n    margin-right: 4px;\n}\n\n.meeting-item .meeting-classification {\n    display: inline-flex;\n    align-items: center;\n    gap: 6px;\n    padding: 6px 12px;\n    border-radius: 16px;\n    font-size: 12px;\n    margin-top: 8px;\n    background: rgba(0, 0, 0, 0.05);\n    color: #323130;\n    font-weight: 500;\n}\n\n.export-section {\n    margin: 32px 0;\n    padding: 24px;\n    text-align: center;\n    background: white;\n    border-radius: 8px;\n    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);\n    border: 1px solid #edebe9;\n    display: flex;\n    justify-content: center;\n    flex-wrap: wrap;\n    gap: 12px;\n}\n\n.loading {\n    text-align: center;\n    padding: 40px 20px;\n    color: #0078d4;\n    transition: opacity 0.3s ease;\n}\n\n.loading > div {\n    display: inline-block;\n    width: 40px;\n    height: 40px;\n    border: 4px solid #f3f2f1;\n    border-top-color: #0078d4;\n    border-radius: 50%;\n    animation: spin 0.8s linear infinite;\n    margin-bottom: 16px;\n}\n\n@keyframes spin {\n    to {\n        transform: rotate(360deg);\n    }\n}\n\n.loading p {\n    margin: 16px 0 0 0;\n    font-weight: 600;\n    font-size: 15px;\n}\n\n.error {\n    padding: 16px 20px;\n    background: #fff4f4;\n    border: 2px solid #d13438;\n    border-left: 5px solid #d13438;\n    border-radius: 8px;\n    color: #d13438;\n    margin: 24px 0;\n    animation: slideIn 0.3s ease;\n    display: flex;\n    align-items: center;\n    gap: 12px;\n}\n\n.error::before {\n    content: '‚ö†Ô∏è';\n    font-size: 20px;\n    flex-shrink: 0;\n}\n\n@keyframes slideIn {\n    from {\n        opacity: 0;\n        transform: translateX(-20px);\n    }\n    to {\n        opacity: 1;\n        transform: translateX(0);\n    }\n}\n\n.stats-grid {\n    display: grid;\n    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n    gap: 16px;\n    margin: 24px 0;\n}\n\n.stats-card {\n    padding: 20px;\n    background: linear-gradient(135deg, #faf9f8 0%, #f3f2f1 100%);\n    border-radius: 8px;\n    border: 1px solid #edebe9;\n    transition: all 0.3s ease;\n    position: relative;\n    overflow: hidden;\n}\n\n.stats-card::before {\n    content: '';\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 4px;\n    height: 100%;\n    background: #0078d4;\n    transform: scaleY(0);\n    transition: transform 0.3s ease;\n}\n\n.stats-card:hover {\n    transform: translateY(-4px);\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);\n    border-color: #0078d4;\n}\n\n.stats-card:hover::before {\n    transform: scaleY(1);\n}\n\n.stats-card h3 {\n    margin: 0 0 12px 0;\n    font-size: 13px;\n    color: #605e5c;\n    text-transform: uppercase;\n    letter-spacing: 0.5px;\n    font-weight: 600;\n}\n\n.stats-card .value {\n    font-size: 32px;\n    font-weight: 700;\n    color: #323130;\n    line-height: 1.2;\n}\n\n.stat-header {\n    margin-bottom: 8px;\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n}\n\n.stat-header strong {\n    font-size: 15px;\n}\n\n.progress-bar {\n    width: 100%;\n    height: 10px;\n    background-color: #edebe9;\n    border-radius: 10px;\n    overflow: hidden;\n    margin-top: 8px;\n    position: relative;\n}\n\n.progress-fill {\n    height: 100%;\n    border-radius: 10px;\n    transition: width 0.6s cubic-bezier(0.4, 0, 0.2, 1);\n    position: relative;\n    overflow: hidden;\n}\n\n.progress-fill::after {\n    content: '';\n    position: absolute;\n    top: 0;\n    left: 0;\n    bottom: 0;\n    right: 0;\n    background: linear-gradient(\n        90deg,\n        transparent,\n        rgba(255, 255, 255, 0.3),\n        transparent\n    );\n    animation: shimmer 2s infinite;\n}\n\n@keyframes shimmer {\n    0% {\n        transform: translateX(-100%);\n    }\n    100% {\n        transform: translateX(100%);\n    }\n}\n\n.progress-fill.red {\n    background-color: #d13438;\n}\n\n.progress-fill.green {\n    background-color: #107c10;\n}\n\n.progress-fill.blue {\n    background-color: #0078d4;\n}\n\n.pagination {\n    margin-top: 20px;\n    text-align: center;\n}\n\n.pagination-controls {\n    display: inline-flex;\n    gap: 5px;\n    align-items: center;\n}\n\n.page-btn {\n    padding: 8px 14px;\n    border: 2px solid #edebe9;\n    background: white;\n    border-radius: 6px;\n    cursor: pointer;\n    font-size: 14px;\n    font-weight: 500;\n    color: #323130;\n    transition: all 0.2s ease;\n    min-width: 40px;\n}\n\n.page-btn:hover:not(.active) {\n    background: #f3f2f1;\n    border-color: #0078d4;\n    transform: translateY(-2px);\n    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\n}\n\n.page-btn.active {\n    background: #0078d4;\n    color: white;\n    border-color: #0078d4;\n    box-shadow: 0 2px 8px rgba(0, 120, 212, 0.3);\n    font-weight: 600;\n}\n\n.page-ellipsis {\n    padding: 0 5px;\n    color: #605e5c;\n}\n\n.settings-panel {\n    margin: 24px 0;\n    padding: 24px;\n    background: white;\n    border: 1px solid #edebe9;\n    border-radius: 8px;\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);\n    animation: slideDown 0.3s ease;\n    position: relative;\n    z-index: 10;\n}\n\n@keyframes slideDown {\n    from {\n        opacity: 0;\n        transform: translateY(-20px);\n    }\n    to {\n        opacity: 1;\n        transform: translateY(0);\n    }\n}\n\n.settings-panel h2 {\n    margin-top: 0;\n    color: #323130;\n}\n\n.settings-content {\n    margin-top: 15px;\n}\n\n.setting-item {\n    margin: 15px 0;\n}\n\n.setting-item label {\n    display: block;\n    margin-bottom: 5px;\n    font-weight: 600;\n    color: #323130;\n}\n\n.setting-item input[type=\"number\"] {\n    width: 120px;\n    padding: 10px 12px;\n    border: 2px solid #edebe9;\n    border-radius: 6px;\n    font-size: 14px;\n    transition: all 0.2s ease;\n}\n\n.setting-item input[type=\"number\"]:focus {\n    outline: none;\n    border-color: #0078d4;\n    box-shadow: 0 0 0 3px rgba(0, 120, 212, 0.1);\n}\n\n.setting-item input[type=\"checkbox\"] {\n    margin-right: 8px;\n}\n\n.setting-actions {\n    margin-top: 20px;\n    display: flex;\n    gap: 10px;\n    flex-wrap: wrap;\n}\n\n.ms-Button--secondary {\n    background-color: #f3f2f1;\n    color: #323130;\n    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\n}\n\n.ms-Button--secondary:hover {\n    background-color: #edebe9;\n    transform: translateY(-1px);\n    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);\n}\n\n.classification-rules-panel {\n    margin: 24px 0;\n    padding: 0;\n    background: white;\n    border: 1px solid #edebe9;\n    border-radius: 8px;\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\n    animation: slideDown 0.3s ease;\n    max-width: 100%;\n    overflow: hidden;\n}\n\n.rules-panel-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    padding: 20px 24px;\n    background: linear-gradient(135deg, #0078d4 0%, #106ebe 100%);\n    color: white;\n    border-bottom: 2px solid rgba(255, 255, 255, 0.2);\n}\n\n.rules-panel-header h2 {\n    margin: 0;\n    font-size: 20px;\n    font-weight: 600;\n}\n\n.close-button {\n    background: rgba(255, 255, 255, 0.2);\n    border: none;\n    color: white;\n    width: 32px;\n    height: 32px;\n    border-radius: 50%;\n    cursor: pointer;\n    font-size: 24px;\n    line-height: 1;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    transition: all 0.2s ease;\n}\n\n.close-button:hover {\n    background: rgba(255, 255, 255, 0.3);\n    transform: rotate(90deg);\n}\n\n.rules-content {\n    padding: 24px;\n}\n\n.rules-tabs {\n    display: flex;\n    gap: 8px;\n    margin-bottom: 24px;\n    border-bottom: 2px solid #edebe9;\n}\n\n.rule-tab {\n    padding: 12px 20px;\n    border: none;\n    background: transparent;\n    border-bottom: 3px solid transparent;\n    cursor: pointer;\n    font-size: 14px;\n    font-weight: 600;\n    color: #605e5c;\n    transition: all 0.2s ease;\n    margin-bottom: -2px;\n}\n\n.rule-tab:hover {\n    color: #0078d4;\n    background: #f3f2f1;\n}\n\n.rule-tab.active {\n    color: #0078d4;\n    border-bottom-color: #0078d4;\n    background: transparent;\n}\n\n.rule-section {\n    min-height: 200px;\n}\n\n.rule-section h3 {\n    margin: 0 0 16px 0;\n    font-size: 16px;\n    font-weight: 600;\n    color: #323130;\n}\n\n.keywords-list {\n    display: flex;\n    flex-wrap: wrap;\n    gap: 8px;\n    margin-bottom: 16px;\n    min-height: 60px;\n    padding: 12px;\n    background: #faf9f8;\n    border-radius: 6px;\n    border: 1px solid #edebe9;\n}\n\n.keyword-tag {\n    display: inline-flex;\n    align-items: center;\n    gap: 6px;\n    padding: 6px 12px;\n    background: white;\n    border: 1px solid #8a8886;\n    border-radius: 16px;\n    font-size: 13px;\n    color: #323130;\n    animation: fadeIn 0.2s ease;\n}\n\n.keyword-tag .remove-keyword {\n    background: #d13438;\n    color: white;\n    border: none;\n    width: 18px;\n    height: 18px;\n    border-radius: 50%;\n    cursor: pointer;\n    font-size: 12px;\n    line-height: 1;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    transition: all 0.2s ease;\n    padding: 0;\n}\n\n.keyword-tag .remove-keyword:hover {\n    background: #a4262c;\n    transform: scale(1.1);\n}\n\n.add-keyword {\n    display: flex;\n    gap: 8px;\n    align-items: center;\n}\n\n.add-keyword input {\n    flex: 1;\n    padding: 10px 12px;\n    border: 2px solid #edebe9;\n    border-radius: 6px;\n    font-size: 14px;\n    transition: all 0.2s ease;\n}\n\n.add-keyword input:focus {\n    outline: none;\n    border-color: #0078d4;\n    box-shadow: 0 0 0 3px rgba(0, 120, 212, 0.1);\n}\n\n.add-btn {\n    padding: 10px 20px;\n    background: #0078d4;\n    color: white;\n    border: none;\n    border-radius: 6px;\n    cursor: pointer;\n    font-size: 14px;\n    font-weight: 600;\n    transition: all 0.2s ease;\n}\n\n.add-btn:hover {\n    background: #106ebe;\n    transform: translateY(-1px);\n    box-shadow: 0 2px 4px rgba(0, 120, 212, 0.3);\n}\n\n.rules-actions {\n    margin-top: 24px;\n    padding-top: 24px;\n    border-top: 1px solid #edebe9;\n    display: flex;\n    gap: 12px;\n    flex-wrap: wrap;\n}\n\n/* Graphiques */\n.charts-container {\n    margin-top: 32px;\n    display: grid;\n    grid-template-columns: 1fr 1fr;\n    gap: 24px;\n    padding-top: 24px;\n    border-top: 2px solid #edebe9;\n}\n\n.chart-wrapper {\n    background: #faf9f8;\n    border: 1px solid #edebe9;\n    border-radius: 8px;\n    padding: 20px;\n    transition: all 0.3s ease;\n}\n\n.chart-wrapper:hover {\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);\n    transform: translateY(-2px);\n}\n\n.chart-wrapper h3 {\n    margin: 0 0 16px 0;\n    font-size: 16px;\n    font-weight: 600;\n    color: #323130;\n    text-align: center;\n}\n\n/* Graphique circulaire */\n.pie-chart {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    gap: 16px;\n}\n\n.pie-svg {\n    width: 200px;\n    height: 200px;\n    animation: fadeIn 0.5s ease;\n}\n\n.pie-segment {\n    transition: opacity 0.2s ease;\n    cursor: pointer;\n}\n\n.pie-segment:hover {\n    opacity: 0.8;\n    filter: brightness(1.1);\n}\n\n.pie-legend {\n    display: flex;\n    flex-direction: column;\n    gap: 8px;\n    margin-top: 16px;\n}\n\n.legend-item {\n    display: flex;\n    align-items: center;\n    gap: 8px;\n    font-size: 13px;\n    color: #323130;\n}\n\n.legend-color {\n    width: 16px;\n    height: 16px;\n    border-radius: 4px;\n    display: inline-block;\n}\n\n.legend-color.red {\n    background: #d13438;\n}\n\n.legend-color.green {\n    background: #107c10;\n}\n\n.legend-color.blue {\n    background: #0078d4;\n}\n\n/* Graphique en barres */\n.bar-chart {\n    width: 100%;\n}\n\n.bar-chart-content {\n    display: flex;\n    flex-direction: column;\n    gap: 12px;\n}\n\n.bar-row {\n    display: grid;\n    grid-template-columns: 80px 1fr 40px;\n    gap: 12px;\n    align-items: center;\n}\n\n.bar-label {\n    font-size: 12px;\n    font-weight: 600;\n    color: #605e5c;\n    text-align: right;\n}\n\n.bar-container {\n    display: flex;\n    height: 24px;\n    border-radius: 4px;\n    overflow: hidden;\n    background: #edebe9;\n    box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.1);\n}\n\n.bar-segment {\n    height: 100%;\n    transition: all 0.3s ease;\n    cursor: pointer;\n    position: relative;\n}\n\n.bar-segment:hover {\n    filter: brightness(1.2);\n    z-index: 1;\n}\n\n.bar-segment.red {\n    background: linear-gradient(135deg, #d13438 0%, #a4262c 100%);\n}\n\n.bar-segment.green {\n    background: linear-gradient(135deg, #107c10 0%, #0b5a0b 100%);\n}\n\n.bar-segment.blue {\n    background: linear-gradient(135deg, #0078d4 0%, #106ebe 100%);\n}\n\n.bar-value {\n    font-size: 13px;\n    font-weight: 600;\n    color: #323130;\n    text-align: center;\n}\n\n.no-data {\n    text-align: center;\n    padding: 40px 20px;\n    color: #605e5c;\n    font-size: 14px;\n}\n\n/* Notifications Toast */\n.toast-container {\n    position: fixed;\n    top: 20px;\n    right: 20px;\n    z-index: 10000;\n    display: flex;\n    flex-direction: column;\n    gap: 12px;\n    max-width: 400px;\n    pointer-events: none;\n}\n\n.toast {\n    background: white;\n    border-radius: 8px;\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\n    padding: 0;\n    opacity: 0;\n    transform: translateX(400px);\n    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n    pointer-events: all;\n    border-left: 4px solid;\n    animation: slideInRight 0.3s ease forwards;\n}\n\n.toast.show {\n    opacity: 1;\n    transform: translateX(0);\n}\n\n.toast.hide {\n    opacity: 0;\n    transform: translateX(400px);\n}\n\n.toast-content {\n    display: flex;\n    align-items: center;\n    gap: 12px;\n    padding: 16px 20px;\n}\n\n.toast-icon {\n    font-size: 20px;\n    flex-shrink: 0;\n}\n\n.toast-message {\n    flex: 1;\n    font-size: 14px;\n    line-height: 1.5;\n    color: #323130;\n}\n\n.toast-close {\n    background: transparent;\n    border: none;\n    color: #605e5c;\n    font-size: 20px;\n    cursor: pointer;\n    padding: 0;\n    width: 24px;\n    height: 24px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    border-radius: 4px;\n    transition: all 0.2s ease;\n    flex-shrink: 0;\n}\n\n.toast-close:hover {\n    background: rgba(0, 0, 0, 0.05);\n    color: #323130;\n}\n\n/* Types de toast */\n.toast-success {\n    border-left-color: #107c10;\n    background: linear-gradient(135deg, #f0f9f0 0%, #ffffff 100%);\n}\n\n.toast-success .toast-icon {\n    color: #107c10;\n}\n\n.toast-error {\n    border-left-color: #d13438;\n    background: linear-gradient(135deg, #fff4f4 0%, #ffffff 100%);\n}\n\n.toast-error .toast-icon {\n    color: #d13438;\n}\n\n.toast-warning {\n    border-left-color: #ff9800;\n    background: linear-gradient(135deg, #fff4e6 0%, #ffffff 100%);\n}\n\n.toast-warning .toast-icon {\n    color: #ff9800;\n}\n\n.toast-info {\n    border-left-color: #0078d4;\n    background: linear-gradient(135deg, #e3f2fd 0%, #ffffff 100%);\n}\n\n.toast-info .toast-icon {\n    color: #0078d4;\n}\n\n@keyframes slideInRight {\n    from {\n        opacity: 0;\n        transform: translateX(400px);\n    }\n    to {\n        opacity: 1;\n        transform: translateX(0);\n    }\n}\n\n@media (max-width: 768px) {\n    .charts-container {\n        grid-template-columns: 1fr;\n    }\n    \n    .bar-row {\n        grid-template-columns: 60px 1fr 30px;\n        gap: 8px;\n    }\n    \n    .bar-label {\n        font-size: 11px;\n    }\n}\n\n/* Am√©lioration de l'accessibilit√© */\n*:focus-visible {\n    outline: 2px solid #0078d4;\n    outline-offset: 2px;\n}\n\n/* Scrollbar personnalis√©e */\n#content-main::-webkit-scrollbar {\n    width: 8px;\n}\n\n#content-main::-webkit-scrollbar-track {\n    background: #f3f2f1;\n}\n\n#content-main::-webkit-scrollbar-thumb {\n    background: #8a8886;\n    border-radius: 4px;\n}\n\n#content-main::-webkit-scrollbar-thumb:hover {\n    background: #605e5c;\n}\n\n/* Animation pour les cartes de statistiques */\n.stats-card {\n    animation: fadeInUp 0.4s ease backwards;\n}\n\n.stats-card:nth-child(1) { animation-delay: 0.1s; }\n.stats-card:nth-child(2) { animation-delay: 0.2s; }\n.stats-card:nth-child(3) { animation-delay: 0.3s; }\n.stats-card:nth-child(4) { animation-delay: 0.4s; }\n\n@keyframes fadeInUp {\n    from {\n        opacity: 0;\n        transform: translateY(20px);\n    }\n    to {\n        opacity: 1;\n        transform: translateY(0);\n    }\n}\n\n/* Animation pour les r√©unions */\n.meeting-item {\n    animation: fadeIn 0.3s ease backwards;\n}\n\n.meeting-item:nth-child(1) { animation-delay: 0.05s; }\n.meeting-item:nth-child(2) { animation-delay: 0.1s; }\n.meeting-item:nth-child(3) { animation-delay: 0.15s; }\n.meeting-item:nth-child(4) { animation-delay: 0.2s; }\n.meeting-item:nth-child(5) { animation-delay: 0.25s; }\n\n/* Virtualisation de listes */\n.meetings-content-virtual {\n    position: relative;\n}\n\n.virtual-scroll-enabled {\n    overflow-y: auto;\n    max-height: 600px;\n    position: relative;\n}\n\n.virtual-scroll-container {\n    position: relative;\n    width: 100%;\n}\n\n.virtual-scroll-content {\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    will-change: transform;\n}\n\n.virtual-scroll-info {\n    margin-top: 12px;\n    padding: 8px 16px;\n    background: #f3f2f1;\n    border-radius: 6px;\n    font-size: 12px;\n    color: #605e5c;\n    text-align: center;\n    border: 1px solid #edebe9;\n}\n\n.virtual-scroll-info span {\n    font-weight: 600;\n}\n\n",""]);const i=s}},n={};function t(o){var r=n[o];if(void 0!==r)return r.exports;var a=n[o]={id:o,exports:{}};return e[o](a,a.exports,t),a.exports}t.n=e=>{var n=e&&e.__esModule?()=>e.default:()=>e;return t.d(n,{a:n}),n},t.d=(e,n)=>{for(var o in n)t.o(n,o)&&!t.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:n[o]})},t.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),t.o=(e,n)=>Object.prototype.hasOwnProperty.call(e,n),t.nc=void 0;var o=t(72),r=t.n(o),a=t(825),s=t.n(a),i=t(659),l=t.n(i),c=t(56),d=t.n(c),p=t(540),u=t.n(p),g=t(113),f=t.n(g),m=t(942),x={};x.styleTagTransform=f(),x.setAttributes=d(),x.insert=l().bind(null,"head"),x.domAPI=s(),x.insertStyleElement=u(),r()(m.A,x),m.A&&m.A.locals&&m.A.locals;class h{static isAvailable(){return"undefined"!=typeof Office&&void 0!==Office.context}static isDesktop(){return!!this.isAvailable()&&(Office.context.platform===Office.PlatformType.PC||Office.context.platform===Office.PlatformType.Mac)}static isWindows(){return!!this.isAvailable()&&Office.context.platform===Office.PlatformType.PC}static isMac(){return!!this.isAvailable()&&Office.context.platform===Office.PlatformType.Mac}static async getCalendarItems(e,n){return new Promise((t,o)=>{this.isAvailable()?Office.context.mailbox.getUserIdentityTokenAsync(r=>{"failed"!==r.status?this.getAppointmentsViaAPI(e,n).then(t).catch(o):o(new Error("Impossible d'obtenir le token d'identit√©"))}):o(new Error("Office.js n'est pas disponible"))})}static async getAppointmentsViaAPI(e,n){return new Promise((e,n)=>{n(new Error("M√©thode √† impl√©menter selon la version Exchange"))})}static async getAppointmentsFromCalendar(e,n){return new Promise((e,n)=>{this.isAvailable()?Office.context.mailbox.restUrl?e([]):n(new Error("REST API non disponible - v√©rifiez la version d'Exchange")):n(new Error("Office.js n'est pas disponible"))})}static getExchangeVersion(){if(!this.isAvailable())return null;try{const e=Office.context.mailbox.restUrl;if(e){if(e.includes("/api/v2.0"))return"Exchange 2016+ ou Office 365";if(e.includes("/api/v1.0"))return"Exchange 2013+ ou Office 365";if(e.includes("/EWS/"))return"Exchange 2010+ (EWS)"}const n=(Office.context.mailbox.diagnostics,this.getAvailableCapabilities());return n.includes("REST")?"Exchange 2013+ (REST API disponible)":n.includes("EWS")?"Exchange 2010+ (EWS disponible)":"Version inconnue"}catch(e){return console.warn("Erreur lors de la d√©tection de la version Exchange:",e),null}}static getOutlookVersion(){if(!this.isAvailable())return null;try{const e=Office.context.mailbox.diagnostics;if(e){const n=e.host,t=e.version;if(n&&t)return`${n} ${t}`;if(n)return n}return this.isDesktop()?this.isWindows()?"Outlook Desktop Windows":this.isMac()?"Outlook Desktop Mac":null:"Outlook Web App"}catch(e){return console.warn("Erreur lors de la d√©tection de la version Outlook:",e),null}}static getAvailableCapabilities(){const e=[];if(!this.isAvailable())return e;try{Office.context.mailbox.restUrl&&e.push("REST"),Office.context.mailbox.restUrl?.includes("/EWS/")&&e.push("EWS");const n=Office.context.mailbox;n.item?.itemType&&e.push("Calendar"),n.userProfile&&e.push("UserProfile"),n.searchAsync&&e.push("Search")}catch(e){console.warn("Erreur lors de la d√©tection des capacit√©s:",e)}return e}static hasCapability(e){return this.getAvailableCapabilities().includes(e)}static getDiagnostics(){const e=this.isAvailable()?Office.context.mailbox:null,n=e?.diagnostics;return{platform:this.isAvailable()?Office.context.platform.toString():"Unknown",host:n?.host||null,version:n?.version||null,exchangeVersion:this.getExchangeVersion(),outlookVersion:this.getOutlookVersion(),capabilities:this.getAvailableCapabilities(),isDesktop:this.isDesktop(),isWindows:this.isWindows(),isMac:this.isMac()}}}class b{static generateMockAppointments(e,n){const t=[],o=new Date(e);for(;o<=n;)0!==o.getDay()&&6!==o.getDay()&&t.push({itemId:`mock-${o.getTime()}-1`,subject:"Stand-up quotidien",start:new Date(o.getFullYear(),o.getMonth(),o.getDate(),9,0),end:new Date(o.getFullYear(),o.getMonth(),o.getDate(),9,30),location:"Teams",organizer:{emailAddress:{address:"team@example.com"}},attendees:[{emailAddress:{address:"user1@example.com"}},{emailAddress:{address:"user2@example.com"}}],bodyPreview:"R√©union optionnelle - stand-up quotidien",isAllDayEvent:!1}),2===o.getDay()&&t.push({itemId:`mock-${o.getTime()}-2`,subject:"R√©union de direction obligatoire",start:new Date(o.getFullYear(),o.getMonth(),o.getDate(),14,0),end:new Date(o.getFullYear(),o.getMonth(),o.getDate(),15,30),location:"Salle de r√©union A",organizer:{emailAddress:{address:"directeur@example.com"}},attendees:[{emailAddress:{address:"manager1@example.com"}},{emailAddress:{address:"manager2@example.com"}}],bodyPreview:"R√©union obligatoire - pr√©sence requise",isAllDayEvent:!1}),4===o.getDay()&&o.getDate()<=7&&t.push({itemId:`mock-${o.getTime()}-3`,subject:"Formation client - D√©placement",start:new Date(o.getFullYear(),o.getMonth(),o.getDate(),10,0),end:new Date(o.getFullYear(),o.getMonth(),o.getDate(),16,0),location:"Chez le client",organizer:{emailAddress:{address:"formation@example.com"}},attendees:[{emailAddress:{address:"formateur@example.com"}}],bodyPreview:"Formation externe - d√©placement requis",isAllDayEvent:!1}),o.setDate(o.getDate()+1);return t}static mockGetUserIdentityToken(e){setTimeout(()=>{e({status:"succeeded",value:"mock-token-12345"})},100)}}class y{static async getCalendarEvents(e,n,t){if(!t)throw new Error("Token d'acc√®s requis pour l'API REST");const o=e.toISOString(),r=n.toISOString(),a=this.getRestUrl();if(!a)throw new Error("REST API URL non disponible");if(Math.ceil((n.getTime()-e.getTime())/864e5)>this.BATCH_SIZE_DAYS)return this.getCalendarEventsBatched(e,n,t);const s=`${a}/v2.0/me/calendarview?startDateTime=${encodeURIComponent(o)}&endDateTime=${encodeURIComponent(r)}&$select=subject,start,end,location,organizer,attendees,bodyPreview,isAllDayEvent,id&$top=1000`;try{const e=t||await this.getCachedAccessToken(),n=await this.fetchWithRetry(s,e);if(!n.ok)throw new Error(`Erreur API: ${n.status} ${n.statusText}`);const o=await n.json();let r=o.value||[];return o["@odata.nextLink"]&&(r=await this.fetchAllPages(r,o["@odata.nextLink"],e)),r}catch(e){throw new Error(`Erreur lors de la r√©cup√©ration des √©v√©nements: ${e}`)}}static async getCalendarEventsBatched(e,n,t){const o=[];let r=new Date(e);for(;r<n;){const e=new Date(r);e.setDate(e.getDate()+this.BATCH_SIZE_DAYS),e>n&&e.setTime(n.getTime());const a=await this.getCalendarEvents(r,e,t);o.push(...a),r=new Date(e),r.setDate(r.getDate()+1)}return o}static async fetchAllPages(e,n,t){let o=n;const r=[...e];for(;o;){const e=await this.fetchWithRetry(o,t);if(!e.ok)break;const n=await e.json();r.push(...n.value||[]),o=n["@odata.nextLink"]||null}return r}static async fetchWithRetry(e,n,t=3){let o=null;for(let r=1;r<=t;r++)try{const o=await fetch(e,{method:"GET",headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json"}});if(o.ok||o.status<500&&429!==o.status)return o;if(r<t){const e=Math.min(1e3*Math.pow(2,r-1),1e4);await new Promise(n=>setTimeout(n,e))}}catch(e){if(o=e,r<t){const e=Math.min(1e3*Math.pow(2,r-1),1e4);await new Promise(n=>setTimeout(n,e))}}throw o||new Error("√âchec apr√®s plusieurs tentatives")}static async getCachedAccessToken(){if(this.tokenCache&&this.tokenCache.expiresAt>Date.now())return this.tokenCache.token;const e=await this.getAccessToken();return this.tokenCache={token:e,expiresAt:Date.now()+this.TOKEN_CACHE_TTL},e}static async getAccessToken(){return new Promise((e,n)=>{"undefined"!=typeof Office&&Office.context?Office.context.mailbox.getUserIdentityTokenAsync(t=>{"failed"!==t.status?e(t.value||""):n(new Error("Impossible d'obtenir le token d'identit√©"))}):n(new Error("Office.js n'est pas disponible"))})}static getRestUrl(){return"undefined"!=typeof Office&&Office.context&&Office.context.mailbox.restUrl||null}static isRESTAvailable(){return null!==this.getRestUrl()}static async getCalendarEventsWithFallback(e,n){try{const t=await this.getAccessToken();if(this.isRESTAvailable())return await this.getCalendarEvents(e,n,t);throw new Error("REST API non disponible")}catch(e){throw e}}}y.tokenCache=null,y.TOKEN_CACHE_TTL=33e5,y.BATCH_SIZE_DAYS=30;const w="outlook-analytics-cache-";class v{static get(e){try{const n=localStorage.getItem(`${w}${e}`);if(!n)return null;const t=JSON.parse(n);return Date.now()>t.timestamp+t.expiresIn?(this.remove(e),null):t.data}catch(e){return console.warn("Erreur lors de la r√©cup√©ration du cache:",e),null}}static set(e,n,t=3e5){try{const o={data:n,timestamp:Date.now(),expiresIn:t};localStorage.setItem(`${w}${e}`,JSON.stringify(o))}catch(e){console.warn("Erreur lors de la sauvegarde du cache:",e),this.clearExpired()}}static remove(e){try{localStorage.removeItem(`${w}${e}`)}catch(e){console.warn("Erreur lors de la suppression du cache:",e)}}static clear(){try{Object.keys(localStorage).forEach(e=>{e.startsWith(w)&&localStorage.removeItem(e)})}catch(e){console.warn("Erreur lors du nettoyage du cache:",e)}}static clearExpired(){try{const e=Object.keys(localStorage),n=Date.now();e.forEach(e=>{if(e.startsWith(w))try{const t=localStorage.getItem(e);if(t){const o=JSON.parse(t);n>o.timestamp+o.expiresIn&&localStorage.removeItem(e)}}catch{}})}catch(e){console.warn("Erreur lors du nettoyage des entr√©es expir√©es:",e)}}static generateKey(e,n,t){return`${e}-${n.toISOString()}-${t.toISOString()}`}}class k{async getMeetings(e,n,t=!1,o=!0){if(o&&!t){const t=v.generateKey("meetings",e,n),o=v.get(t);if(o)return o}let r=[];if(t)r=b.generateMockAppointments(e,n);else if(h.isAvailable())try{h.getDiagnostics().isDesktop?(console.log("[MeetingService] Mode Outlook Desktop d√©tect√©"),h.hasCapability("REST")&&y.isRESTAvailable()?(console.log("[MeetingService] Utilisation de l'API REST"),r=await y.getCalendarEventsWithFallback(e,n)):(console.log("[MeetingService] Utilisation de l'API Office.js standard (fallback Desktop)"),r=await h.getCalendarItems(e,n))):(console.log("[MeetingService] Mode Outlook Web App d√©tect√©"),r=y.isRESTAvailable()?await y.getCalendarEventsWithFallback(e,n):await h.getCalendarItems(e,n))}catch(t){console.warn("[MeetingService] Erreur lors de la r√©cup√©ration des r√©unions, utilisation du mock:",t),r=b.generateMockAppointments(e,n)}else console.warn("Office.js non disponible, utilisation du mock"),r=b.generateMockAppointments(e,n);const a=this.parseAppointments(r);if(o&&!t){const t=v.generateKey("meetings",e,n);v.set(t,a,3e5)}return a}parseAppointments(e){return e.map(e=>this.parseAppointment(e))}parseAppointment(e){const n=new Date(e.start),t=new Date(e.end),o=Math.round((t.getTime()-n.getTime())/6e4);return{id:e.itemId||this.generateId(),subject:e.subject||"Sans objet",start:n,end:t,duration:o,location:e.location,organizer:e.organizer?.emailAddress?.address,attendees:this.extractAttendees(e),body:e.bodyPreview||e.body,isAllDay:e.isAllDayEvent||!1}}extractAttendees(e){return e.attendees?e.attendees.map(e=>e.emailAddress?.address||e.displayName||"").filter(e=>""!==e):[]}generateId(){return`meeting-${Date.now()}-${Math.random().toString(36).substr(2,9)}`}filterByDateRange(e,n,t){return e.filter(e=>e.start>=n&&e.end<=t)}}var E;!function(e){e.RED="red",e.GREEN="green",e.BLUE="blue",e.DEFAULT="gray"}(E||(E={}));class A{constructor(e){this.priority=["noFlex","deplacement","flex"],this.defaultColor=E.DEFAULT,this.rules=e||this.getDefaultRules()}static fromJSON(e){const n=new A;return n.loadRulesFromJSON(e),n}loadRulesFromJSON(e){const n=e=>e.map(e=>{const n=e.match(/^\/(.*)\/([gimuy]*)$/);return n?new RegExp(n[1],n[2]):new RegExp(e,"i")});this.rules={noFlex:{keywords:e.noFlex.keywords||[],patterns:n(e.noFlex.patterns||[])},flex:{keywords:e.flex.keywords||[],patterns:n(e.flex.patterns||[])},deplacement:{keywords:e.deplacement.keywords||[],patterns:n(e.deplacement.patterns||[])}},e.priority&&(this.priority=e.priority),e.defaultColor&&(this.defaultColor=e.defaultColor)}getDefaultRules(){return{noFlex:{keywords:["obligatoire","requis","required","mandatory","direction","validation","comit√©","board","r√©union importante"],patterns:[/r√©union\s+(de\s+)?direction/i,/comit√©\s+(de\s+)?direction/i,/validation\s+(obligatoire)?/i]},flex:{keywords:["optionnel","optional","info","information","stand-up","standup","point","brief"],patterns:[/stand[- ]?up/i,/point\s+(d'|de\s+)?info/i,/r√©union\s+optionnelle/i]},deplacement:{keywords:["d√©placement","formation","training","external","externe","client","customer","on-site","sur site","d√©placement"],patterns:[/formation/i,/training/i,/d√©placement/i,/chez\s+(le\s+)?client/i,/on[- ]?site/i]}}}classifyMeeting(e){const n=`${e.subject?.toLowerCase()||""} ${e.body?.toLowerCase()||""} ${e.location?.toLowerCase()||""}`;for(const t of this.priority){const o=t;if(this.matchesRules(n,this.rules[o]))return this.createClassifiedMeeting(e,o)}return{...e,color:this.defaultColor,classificationReason:"Non classifi√©"}}createClassifiedMeeting(e,n){return{...e,color:{noFlex:E.RED,deplacement:E.BLUE,flex:E.GREEN}[n],classificationReason:{noFlex:"No Flex - R√©union obligatoire",deplacement:"D√©placement/Formation",flex:"Flex - R√©union optionnelle"}[n]}}matchesRules(e,n){return!!n.keywords.some(n=>e.includes(n.toLowerCase()))||!!n.patterns.some(n=>n.test(e))}classifyMeetings(e){return e.map(e=>this.classifyMeeting(e))}updateRules(e){e.noFlex&&(this.rules.noFlex={...this.rules.noFlex,keywords:e.noFlex.keywords||this.rules.noFlex.keywords,patterns:e.noFlex.patterns||this.rules.noFlex.patterns}),e.flex&&(this.rules.flex={...this.rules.flex,keywords:e.flex.keywords||this.rules.flex.keywords,patterns:e.flex.patterns||this.rules.flex.patterns}),e.deplacement&&(this.rules.deplacement={...this.rules.deplacement,keywords:e.deplacement.keywords||this.rules.deplacement.keywords,patterns:e.deplacement.patterns||this.rules.deplacement.patterns})}getRules(){return{noFlex:{keywords:[...this.rules.noFlex.keywords],patterns:[...this.rules.noFlex.patterns]},flex:{keywords:[...this.rules.flex.keywords],patterns:[...this.rules.flex.patterns]},deplacement:{keywords:[...this.rules.deplacement.keywords],patterns:[...this.rules.deplacement.patterns]}}}}class D{calculateStatistics(e){if(0===e.length)return this.getEmptyStatistics();const n=e.length,t=this.calculateTotalDuration(e),o=t/n,r=this.calculateCountByColor(e),a=this.calculateDurationByColor(e),s=this.getDateRange(e),i=Math.ceil((s.end.getTime()-s.start.getTime())/864e5),l=i/7,c=i/30;return{total:n,totalDuration:t,averageDuration:o,byColor:r,byColorDuration:a,weeklyFrequency:l>0?n/l:0,monthlyFrequency:c>0?n/c:0,averagePerDay:i>0?n/i:0,busiestDays:this.findBusiestDays(e),busiestHours:this.findBusiestHours(e)}}calculateTotalDuration(e){return e.reduce((e,n)=>e+n.duration,0)}calculateCountByColor(e){const n={red:0,green:0,blue:0,default:0};return e.forEach(e=>{switch(e.color){case E.RED:n.red++;break;case E.GREEN:n.green++;break;case E.BLUE:n.blue++;break;default:n.default++}}),n}calculateDurationByColor(e){const n={red:0,green:0,blue:0,default:0};return e.forEach(e=>{switch(e.color){case E.RED:n.red+=e.duration;break;case E.GREEN:n.green+=e.duration;break;case E.BLUE:n.blue+=e.duration;break;default:n.default+=e.duration}}),n}getDateRange(e){if(0===e.length){const e=new Date;return{start:e,end:e}}const n=e.map(e=>e.start);return{start:new Date(Math.min(...n.map(e=>e.getTime()))),end:new Date(Math.max(...n.map(e=>e.getTime())))}}findBusiestDays(e){const n=new Map;return e.forEach(e=>{const t=e.start.toISOString().split("T")[0];n.set(t,(n.get(t)||0)+1)}),Array.from(n.entries()).map(([e,n])=>({date:e,count:n})).sort((e,n)=>n.count-e.count).slice(0,10)}findBusiestHours(e){const n=new Map;return e.forEach(e=>{const t=e.start.getHours();n.set(t,(n.get(t)||0)+1)}),Array.from(n.entries()).map(([e,n])=>({hour:e,count:n})).sort((e,n)=>n.count-e.count).slice(0,10)}getEmptyStatistics(){return{total:0,totalDuration:0,averageDuration:0,byColor:{red:0,green:0,blue:0,default:0},byColorDuration:{red:0,green:0,blue:0,default:0},weeklyFrequency:0,monthlyFrequency:0,averagePerDay:0,busiestDays:[],busiestHours:[]}}}const I={defaultDateRange:{days:30},meetingsPerPage:20,autoLoad:!1,theme:"light"},C="outlook-analytics-preferences";class S{static loadPreferences(){try{const e=localStorage.getItem(C);if(e){const n=JSON.parse(e);return{...I,...n}}}catch(e){console.warn("Erreur lors du chargement des pr√©f√©rences:",e)}return{...I}}static savePreferences(e){try{localStorage.setItem(C,JSON.stringify(e))}catch(e){throw console.error("Erreur lors de la sauvegarde des pr√©f√©rences:",e),new Error("Impossible de sauvegarder les pr√©f√©rences")}}static updatePreferences(e){const n={...this.loadPreferences(),...e};this.savePreferences(n)}static resetPreferences(){try{localStorage.removeItem(C)}catch(e){console.error("Erreur lors de la r√©initialisation:",e)}}static getPreference(e){return this.loadPreferences()[e]}static setPreference(e,n){this.updatePreferences({[e]:n})}}class T{static formatError(e){return e instanceof Error?e.message:"string"==typeof e?e:"Une erreur inattendue s'est produite"}static logError(e,n){const t=this.formatError(e),o=n?`[${n}] ${t}`:t;console.error(o,e)}static isOfficeError(e){const n=this.formatError(e).toLowerCase();return n.includes("office.js")||n.includes("office")||n.includes("outlook")||n.includes("exchange")}static getUserFriendlyMessage(e){const n=this.formatError(e);return this.isOfficeError(e)?"Impossible de se connecter √† Outlook. Veuillez v√©rifier que vous √™tes connect√© et r√©essayez.":n.includes("r√©seau")||n.includes("network")||n.includes("fetch")?"Erreur de connexion. V√©rifiez votre connexion r√©seau et r√©essayez.":n.includes("permission")||n.includes("acc√®s")?"Permissions insuffisantes. Veuillez contacter votre administrateur.":`Erreur : ${n}`}}let $,R,M;Office.onReady(e=>{e.host===Office.HostType.Outlook&&("loading"===document.readyState?document.addEventListener("DOMContentLoaded",F):F())});let B=[],P=1,O=!1,L=null;function F(){if(console.log("[Analytics] üöÄ Initialisation de l'application..."),console.log("[Analytics] √âtat du DOM:",document.readyState),$=new k,R=new A,M=new D,function(){const e=S.loadPreferences();if(e.classificationRules)try{const n=e.classificationRules,t={};n.noFlex&&(t.noFlex={keywords:n.noFlex.keywords||[],patterns:(n.noFlex.patterns||[]).map(e=>{const n=e.match(/^\/(.*)\/([gimuy]*)$/);return n?new RegExp(n[1],n[2]):new RegExp(e)})}),n.flex&&(t.flex={keywords:n.flex.keywords||[],patterns:(n.flex.patterns||[]).map(e=>{const n=e.match(/^\/(.*)\/([gimuy]*)$/);return n?new RegExp(n[1],n[2]):new RegExp(e)})}),n.deplacement&&(t.deplacement={keywords:n.deplacement.keywords||[],patterns:(n.deplacement.patterns||[]).map(e=>{const n=e.match(/^\/(.*)\/([gimuy]*)$/);return n?new RegExp(n[1],n[2]):new RegExp(e)})}),R.updateRules(t)}catch(e){console.warn("Erreur lors du chargement des r√®gles de classification:",e)}}(),h.isAvailable()){const e=h.getDiagnostics();console.log("[Analytics] Informations de diagnostic:",e),console.log(`[Analytics] Plateforme: ${e.platform}`),console.log(`[Analytics] Host: ${e.host||"N/A"}`),console.log(`[Analytics] Version Outlook: ${e.outlookVersion||"N/A"}`),console.log(`[Analytics] Version Exchange: ${e.exchangeVersion||"N/A"}`),console.log(`[Analytics] Capacit√©s disponibles: ${e.capabilities.join(", ")||"Aucune"}`),e.capabilities.includes("REST")||e.capabilities.includes("EWS")||console.warn("[Analytics] ‚ö†Ô∏è Aucune API REST ou EWS d√©tect√©e. Certaines fonctionnalit√©s peuvent √™tre limit√©es.")}setTimeout(()=>{!function(){console.log("[Analytics] Configuration des event listeners...");const e=document.getElementById("loadMeetings"),n=document.getElementById("exportCSV"),t=document.getElementById("exportJSON"),o=document.getElementById("filterRed"),r=document.getElementById("filterGreen"),a=document.getElementById("filterBlue"),s=document.getElementById("sortBy"),i=document.getElementById("settingsButton"),l=document.getElementById("saveSettings"),c=document.getElementById("cancelSettings"),d=document.getElementById("resetSettings"),p=document.getElementById("classificationRulesButton"),u=document.getElementById("closeRulesPanel"),g=document.getElementById("saveRules"),f=document.getElementById("resetRules");if(console.log("[Analytics] Bouton settingsButton trouv√©:",!!i),e&&e.addEventListener("click",U),n&&n.addEventListener("click",()=>V("csv")),t&&t.addEventListener("click",()=>V("json")),o&&r&&a&&[o,r,a].forEach(e=>{e.addEventListener("change",()=>q(B))}),s&&s.addEventListener("change",()=>q(B)),i)console.log("[Analytics] Attachement de l'event listener au bouton param√®tres"),i.addEventListener("click",e=>{e.preventDefault(),e.stopPropagation(),console.log("[Analytics] ‚úÖ Bouton param√®tres cliqu√© !"),Q()}),console.log("[Analytics] Bouton param√®tres:",i),console.log("[Analytics] Bouton param√®tres parent:",i.parentElement);else{console.error("[Analytics] ‚ùå Bouton settingsButton non trouv√© dans le DOM"),console.error("[Analytics] √âl√©ments disponibles:",document.querySelectorAll("button").length);const e=Array.from(document.querySelectorAll("button")).find(e=>e.textContent?.includes("Param√®tres"));console.log('[Analytics] Bouton avec texte "Param√®tres":',e)}l&&l.addEventListener("click",ne),c&&c.addEventListener("click",()=>Q(!1)),d&&d.addEventListener("click",te),p&&p.addEventListener("click",()=>oe()),u&&u.addEventListener("click",()=>oe(!1)),g&&g.addEventListener("click",ie),f&&f.addEventListener("click",le),document.querySelectorAll(".rule-tab").forEach(e=>{e.addEventListener("click",()=>{var n;n=e.getAttribute("data-tab")||"noFlex",document.querySelectorAll(".rule-tab").forEach(e=>{e.getAttribute("data-tab")===n?e.classList.add("active"):e.classList.remove("active")}),document.querySelectorAll(".rule-section").forEach(e=>{e.id===`${n}Rules`?e.style.display="block":e.style.display="none"})})}),document.querySelectorAll(".add-btn").forEach(e=>{e.addEventListener("click",()=>{const n=e.getAttribute("data-category");n&&se(n)})}),["noFlexKeywordInput","flexKeywordInput","deplacementKeywordInput"].forEach(e=>{const n=document.getElementById(e);n&&n.addEventListener("keypress",n=>{"Enter"===n.key&&se(e.replace("KeywordInput",""))})})}(),z(),S.loadPreferences().autoLoad&&U(),console.log("[Analytics] ‚úÖ Initialisation termin√©e")},100)}function z(){const e=S.loadPreferences(),n=e.defaultDateRange?.days||30,t=new Date,o=new Date;o.setDate(o.getDate()-n);const r=document.getElementById("startDate"),a=document.getElementById("endDate");r&&(r.value=j(o)),a&&(a.value=j(t))}function j(e){return e.toISOString().split("T")[0]}async function U(){const e=document.getElementById("startDate"),n=document.getElementById("endDate");if(!e||!n)return void G("Impossible de r√©cup√©rer les dates");const t=new Date(e.value),o=new Date(n.value);if(isNaN(t.getTime())||isNaN(o.getTime()))G("Veuillez s√©lectionner des dates valides");else{_(!0);try{const e=!h.isAvailable(),n=await $.getMeetings(t,o,e),r=R.classifyMeetings(n);B=r,P=1,N(r),q(r),e&&G("Mode d√©veloppement : Donn√©es mock√©es (Office.js non disponible)","info")}catch(e){T.logError(e,"loadMeetings"),G(T.getUserFriendlyMessage(e))}finally{_(!1)}}}function N(e){const n=document.getElementById("statsContent");if(!n)return;const t=M.calculateStatistics(e),o=Math.floor(t.totalDuration/60),r=t.totalDuration%60,a=t.total||1,s=t.byColor.red/a*100,i=t.byColor.green/a*100,l=t.byColor.blue/a*100;n.innerHTML=`\n    <div class="stats-grid">\n      <div class="stats-card">\n        <h3>Total r√©unions</h3>\n        <div class="value">${t.total}</div>\n      </div>\n      <div class="stats-card">\n        <h3>Temps total</h3>\n        <div class="value">${o}h ${r}min</div>\n      </div>\n      <div class="stats-card">\n        <h3>Dur√©e moyenne</h3>\n        <div class="value">${Math.round(t.averageDuration)} min</div>\n      </div>\n      <div class="stats-card">\n        <h3>Par semaine</h3>\n        <div class="value">${Math.round(10*t.weeklyFrequency)/10}</div>\n      </div>\n    </div>\n    <div class="stat-item">\n      <div class="stat-header">\n        <strong>üî¥ No Flex:</strong>\n        <span>${t.byColor.red} r√©unions ‚Ä¢ ${Math.round(t.byColorDuration.red/60)}h</span>\n      </div>\n      <div class="progress-bar">\n        <div class="progress-fill red" style="width: ${s}%"></div>\n      </div>\n    </div>\n    <div class="stat-item">\n      <div class="stat-header">\n        <strong>üü¢ Flex:</strong>\n        <span>${t.byColor.green} r√©unions ‚Ä¢ ${Math.round(t.byColorDuration.green/60)}h</span>\n      </div>\n      <div class="progress-bar">\n        <div class="progress-fill green" style="width: ${i}%"></div>\n      </div>\n    </div>\n    <div class="stat-item">\n      <div class="stat-header">\n        <strong>üîµ D√©placement/Formation:</strong>\n        <span>${t.byColor.blue} r√©unions ‚Ä¢ ${Math.round(t.byColorDuration.blue/60)}h</span>\n      </div>\n      <div class="progress-bar">\n        <div class="progress-fill blue" style="width: ${l}%"></div>\n      </div>\n    </div>\n  `,function(e,n){(function(e){const n=document.getElementById("pieChart");if(!n)return;const t=e.total||1,o=e.byColor.red/t*100,r=e.byColor.green/t*100,a=e.byColor.blue/t*100,s=r/100*360,i=a/100*360;let l=0;let c='<svg viewBox="0 0 200 200" class="pie-svg">';if(o>0){const e=l+o/100*360;c+=`<path d="${H(100,100,80,l,e)}" fill="#d13438" class="pie-segment" data-color="red" />`,l=e}if(r>0){const e=l+s;c+=`<path d="${H(100,100,80,l,e)}" fill="#107c10" class="pie-segment" data-color="green" />`,l=e}a>0&&(c+=`<path d="${H(100,100,80,l,l+i)}" fill="#0078d4" class="pie-segment" data-color="blue" />`),c+="</svg>";const d=`\n    <div class="pie-legend">\n      <div class="legend-item">\n        <span class="legend-color red"></span>\n        <span>No Flex: ${e.byColor.red} (${Math.round(o)}%)</span>\n      </div>\n      <div class="legend-item">\n        <span class="legend-color green"></span>\n        <span>Flex: ${e.byColor.green} (${Math.round(r)}%)</span>\n      </div>\n      <div class="legend-item">\n        <span class="legend-color blue"></span>\n        <span>D√©placement: ${e.byColor.blue} (${Math.round(a)}%)</span>\n      </div>\n    </div>\n  `;n.innerHTML=c+d})(n),function(e){const n=document.getElementById("barChart");if(!n)return;const t={};e.forEach(e=>{const n=function(e){const n=new Date(e);n.setHours(0,0,0,0);const t=n.getDay(),o=n.getDate()-t+(0===t?-6:1),r=new Date(n.setDate(o));return`${r.getFullYear()}-W${function(e){const n=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate())),t=n.getUTCDay()||7;n.setUTCDate(n.getUTCDate()+4-t);const o=new Date(Date.UTC(n.getUTCFullYear(),0,1));return Math.ceil(((n.getTime()-o.getTime())/864e5+1)/7)}(r)}`}(e.start);t[n]||(t[n]={red:0,green:0,blue:0}),"red"===e.color?t[n].red++:"green"===e.color?t[n].green++:"blue"===e.color&&t[n].blue++});const o=Object.keys(t).sort(),r=Math.max(...o.map(e=>t[e].red+t[e].green+t[e].blue),1);let a='<div class="bar-chart-content">';o.forEach(e=>{const n=t[e],o=n.red+n.green+n.blue,s=n.red/r*100,i=n.green/r*100,l=n.blue/r*100;a+=`\n      <div class="bar-row">\n        <div class="bar-label">${function(e){const[n,t]=e.split("-W");return`S${t} ${n}`}(e)}</div>\n        <div class="bar-container">\n          <div class="bar-segment red" style="width: ${s}%" title="No Flex: ${n.red}"></div>\n          <div class="bar-segment green" style="width: ${i}%" title="Flex: ${n.green}"></div>\n          <div class="bar-segment blue" style="width: ${l}%" title="D√©placement: ${n.blue}"></div>\n        </div>\n        <div class="bar-value">${o}</div>\n      </div>\n    `}),a+="</div>",n.innerHTML=a}(e)}(e,t)}function H(e,n,t,o,r){const a=Y(e,n,t,r),s=Y(e,n,t,o),i=r-o<=180?"0":"1";return["M",e,n,"L",a.x,a.y,"A",t,t,0,i,0,s.x,s.y,"Z"].join(" ")}function Y(e,n,t,o){const r=(o-90)*Math.PI/180;return{x:e+t*Math.cos(r),y:n+t*Math.sin(r)}}function q(e){const n=document.getElementById("meetingsContent"),t=document.getElementById("meetingsCount"),o=document.getElementById("pagination");if(!n)return;const r=document.getElementById("filterRed")?.checked??!0,a=document.getElementById("filterGreen")?.checked??!0,s=document.getElementById("filterBlue")?.checked??!0,i=document.getElementById("sortBy")?.value||"date-desc";let l=e.filter(e=>"red"===e.color?r:"green"===e.color?a:"blue"!==e.color||s);if(t&&(t.textContent=`${l.length} r√©union${l.length>1?"s":""}`),l=function(e,n){const t=[...e];switch(n){case"date-asc":t.sort((e,n)=>e.start.getTime()-n.start.getTime());break;case"date-desc":t.sort((e,n)=>n.start.getTime()-e.start.getTime());break;case"duration-asc":t.sort((e,n)=>e.duration-n.duration);break;case"duration-desc":t.sort((e,n)=>n.duration-e.duration);break;case"subject-asc":t.sort((e,n)=>e.subject.localeCompare(n.subject,"fr"));break;case"subject-desc":t.sort((e,n)=>n.subject.localeCompare(e.subject,"fr"))}return t}(l,i),0===l.length)return n.innerHTML='\n      <div class="no-meetings">\n        <p>Aucune r√©union trouv√©e pour cette p√©riode.</p>\n        <p style="margin-top: 8px; font-size: 14px; opacity: 0.7;">\n          Essayez de modifier les filtres ou la p√©riode de dates.\n        </p>\n      </div>\n    ',void(o&&(o.innerHTML=""));const c=S.loadPreferences().meetingsPerPage||20,d=Math.ceil(l.length/c),p=(P-1)*c,u=p+c,g=l.slice(p,u),f=g.length>50;var m;if(f&&!O?(O=!0,(m=n).classList.add("virtual-scroll-enabled"),m.style.overflowY="auto",m.style.maxHeight="600px"):!f&&O&&(O=!1,function(e){e.classList.remove("virtual-scroll-enabled"),e.style.overflowY="",e.style.maxHeight="",L&&(L.disconnect(),L=null)}(n)),O?function(e,n){const t=120,o=e.clientHeight||600,r=Math.ceil(o/t)+10,a=Math.min(0+r,n.length),s=n.length*t,i=document.getElementById("virtualScrollInfo"),l=document.getElementById("visibleCount"),c=document.getElementById("totalCount");i&&(i.style.display="block"),l&&(l.textContent=a.toString()),c&&(c.textContent=n.length.toString());const d=n.slice(0,a),p=document.createElement("div");p.className="virtual-scroll-container",p.style.cssText=`height: ${s}px; position: relative;`;const u=document.createElement("div");u.className="virtual-scroll-content",u.style.cssText="transform: translateY(0px);",d.forEach((e,n)=>{const t=document.createElement("div");t.innerHTML=W(e,0+n);const o=t.firstElementChild;o&&u.appendChild(o)}),p.appendChild(u),e.innerHTML="",e.appendChild(p),function(e,n,t,o,r,a,s){let i=0,l=s,c=!1;const d=()=>{c||(c=!0,requestAnimationFrame(()=>{const a=e.scrollTop,s=e.clientHeight,d=Math.max(0,Math.floor(a/o)-r),p=Math.min(t.length,Math.ceil((a+s)/o)+r);if(d!==i||p!==l){i=d,l=p;const e=t.slice(i,l),r=i*o;n.style.transform=`translateY(${r}px)`,n.innerHTML=e.map((e,n)=>W(e,i+n)).join("");const a=document.getElementById("visibleCount"),s=document.getElementById("totalCount");a&&(a.textContent=l.toString()),s&&(s.textContent=t.length.toString())}c=!1}))};e.addEventListener("scroll",d,{passive:!0}),L&&L.disconnect();L=new IntersectionObserver(()=>{d()},{root:e,rootMargin:"200px",threshold:0}),L.observe(n)}(e,u,n,t,r,0,a)}(n,g):function(e,n){const t=document.getElementById("virtualScrollInfo");t&&(t.style.display="none"),e.innerHTML=n.map((e,n)=>W(e,n)).join("")}(n,g),o&&d>1){let e='<div class="pagination-controls">';P>1&&(e+=`<button class="page-btn" onclick="goToPage(${P-1})">‚Äπ Pr√©c√©dent</button>`);for(let n=1;n<=d;n++)1===n||n===d||n>=P-2&&n<=P+2?e+=`<button class="page-btn ${n===P?"active":""}" onclick="goToPage(${n})">${n}</button>`:n!==P-3&&n!==P+3||(e+='<span class="page-ellipsis">...</span>');P<d&&(e+=`<button class="page-btn" onclick="goToPage(${P+1})">Suivant ‚Ä∫</button>`),e+="</div>",o.innerHTML=e}else o&&(o.innerHTML="")}function W(e,n){const t=e.start.toLocaleDateString("fr-FR",{weekday:"short",year:"numeric",month:"short",day:"numeric"}),o=`${e.start.toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"})} - ${e.end.toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"})}`,r=e.duration>=60?"‚è±Ô∏è":"‚è∞",a=e.location?"üìç":"";return`\n    <div class="meeting-item ${e.color}" data-index="${n}">\n      <div class="meeting-subject">${J(e.subject)}</div>\n      <div class="meeting-details">\n        <span>${t}</span>\n        <span>${o}</span>\n        <span>${r} ${e.duration} min</span>\n        ${e.location?`<span>${a} ${J(e.location)}</span>`:""}\n      </div>\n      <div class="meeting-classification">\n        <span>üè∑Ô∏è</span>\n        ${J(e.classificationReason||"")}\n      </div>\n    </div>\n  `}function V(e){var n;0!==B.length?"csv"===e?(function(e){K([["Sujet","Date d√©but","Date fin","Dur√©e (min)","Couleur","Classification","Lieu"],...e.map(e=>[e.subject,e.start.toISOString(),e.end.toISOString(),e.duration.toString(),e.color,e.classificationReason||"",e.location||""])].map(e=>e.map(e=>`"${e}"`).join(",")).join("\n"),"meetings-analytics.csv","text/csv")}(B),G("Export CSV r√©ussi","success")):(n=B,K(JSON.stringify(n,null,2),"meetings-analytics.json","application/json"),G("Export JSON r√©ussi","success")):G("Aucune donn√©e √† exporter")}function K(e,n,t){const o=new Blob([e],{type:t}),r=URL.createObjectURL(o),a=document.createElement("a");a.href=r,a.download=n,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(r)}function J(e){const n=document.createElement("div");return n.textContent=e,n.innerHTML}function _(e){const n=document.getElementById("loading");n&&(e?(n.style.display="block",n.offsetHeight,n.style.opacity="1"):(n.style.opacity="0",setTimeout(()=>{n.style.display="none"},300)))}function G(e,n="error"){!function(e,n="info",t=4e3){const o=document.getElementById("toastContainer");if(!o)return;const r=document.createElement("div");r.className=`toast toast-${n}`;const a={success:"‚úÖ",error:"‚ùå",warning:"‚ö†Ô∏è",info:"‚ÑπÔ∏è"};r.innerHTML=`\n    <div class="toast-content">\n      <span class="toast-icon">${a[n]||a.info}</span>\n      <span class="toast-message">${J(e)}</span>\n      <button class="toast-close" aria-label="Fermer">√ó</button>\n    </div>\n  `,o.appendChild(r),setTimeout(()=>{r.classList.add("show")},10);const s=r.querySelector(".toast-close");s&&s.addEventListener("click",()=>{X(r)}),t>0&&setTimeout(()=>{X(r)},t)}(e,n)}function X(e){e.classList.remove("show"),e.classList.add("hide"),setTimeout(()=>{e.parentNode&&e.parentNode.removeChild(e)},300)}function Z(){}function Q(e){const n=document.getElementById("settingsPanel");if(!n)return void console.error("Panneau settingsPanel non trouv√©");const t="none"!==n.style.display,o=void 0!==e?e:!t;console.log("toggleSettings:",{isVisible:t,shouldShow:o,show:e}),o?(n.style.display="block",n.style.visibility="visible",ee(),n.scrollIntoView({behavior:"smooth",block:"nearest"})):(n.style.display="none",n.style.visibility="hidden")}function ee(){const e=S.loadPreferences(),n=document.getElementById("defaultDays"),t=document.getElementById("meetingsPerPage"),o=document.getElementById("autoLoad");n&&(n.value=(e.defaultDateRange?.days||30).toString()),t&&(t.value=(e.meetingsPerPage||20).toString()),o&&(o.checked=e.autoLoad||!1)}function ne(){const e=document.getElementById("defaultDays"),n=document.getElementById("meetingsPerPage"),t=document.getElementById("autoLoad");try{S.updatePreferences({defaultDateRange:{days:parseInt(e?.value||"30",10)},meetingsPerPage:parseInt(n?.value||"20",10),autoLoad:t?.checked||!1}),P=1,z(),B.length>0&&q(B),Q(!1),G("Param√®tres enregistr√©s avec succ√®s","success"),setTimeout(Z,3e3)}catch(e){G("Erreur lors de la sauvegarde des param√®tres")}}function te(){confirm("√ätes-vous s√ªr de vouloir r√©initialiser tous les param√®tres ?")&&(S.resetPreferences(),ee(),z(),G("Param√®tres r√©initialis√©s","info"),setTimeout(Z,3e3))}function oe(e){const n=document.getElementById("classificationRulesPanel");if(!n)return;const t="none"!==n.style.display;(void 0!==e?e:!t)?(n.style.display="block",re()):n.style.display="none"}function re(){const e=R.getRules();["noFlex","flex","deplacement"].forEach(n=>{const t=document.getElementById(`${n}Keywords`);t&&(t.innerHTML="",(e[n].keywords||[]).forEach(e=>{ae(n,e)}))})}function ae(e,n){const t=document.getElementById(`${e}Keywords`);if(!t)return;const o=document.createElement("div");o.className="keyword-tag",o.innerHTML=`\n    <span>${J(n)}</span>\n    <button class="remove-keyword" data-category="${e}" data-keyword="${J(n)}">√ó</button>\n  `;const r=o.querySelector(".remove-keyword");r&&r.addEventListener("click",()=>{o.remove()}),t.appendChild(o)}function se(e){const n=document.getElementById(`${e}KeywordInput`);if(!n)return;const t=n.value.trim().toLowerCase();t?Array.from(document.querySelectorAll(`#${e}Keywords .keyword-tag span`)).map(e=>e.textContent?.toLowerCase()).includes(t)?G("Ce mot-cl√© existe d√©j√†","warning"):(ae(e,t),n.value="",n.focus()):G("Veuillez entrer un mot-cl√©","warning")}function ie(){const e=R.getRules(),n={noFlex:{keywords:[],patterns:e.noFlex.patterns.map(e=>e.toString())},flex:{keywords:[],patterns:e.flex.patterns.map(e=>e.toString())},deplacement:{keywords:[],patterns:e.deplacement.patterns.map(e=>e.toString())}};["noFlex","flex","deplacement"].forEach(e=>{const t=document.getElementById(`${e}Keywords`);if(t){const o=Array.from(t.querySelectorAll(".keyword-tag span")).map(e=>e.textContent||"");n[e].keywords=o}}),S.updatePreferences({classificationRules:n});const t={noFlex:{keywords:n.noFlex.keywords,patterns:n.noFlex.patterns.map(e=>{const n=e.match(/^\/(.*)\/([gimuy]*)$/);return n?new RegExp(n[1],n[2]):new RegExp(e)})},flex:{keywords:n.flex.keywords,patterns:n.flex.patterns.map(e=>{const n=e.match(/^\/(.*)\/([gimuy]*)$/);return n?new RegExp(n[1],n[2]):new RegExp(e)})},deplacement:{keywords:n.deplacement.keywords,patterns:n.deplacement.patterns.map(e=>{const n=e.match(/^\/(.*)\/([gimuy]*)$/);return n?new RegExp(n[1],n[2]):new RegExp(e)})}};if(R.updateRules(t),B.length>0){const e=B.map(e=>{const{color:n,classificationReason:t,...o}=e;return o});B=R.classifyMeetings(e),q(B),N(B)}G("R√®gles de classification enregistr√©es avec succ√®s","success"),setTimeout(()=>{oe(!1)},2e3)}function le(){if(confirm("√ätes-vous s√ªr de vouloir r√©initialiser les r√®gles de classification aux valeurs par d√©faut ?")){const e=(new A).getRules();R.updateRules(e);const n={noFlex:{keywords:e.noFlex.keywords,patterns:e.noFlex.patterns.map(e=>e.toString())},flex:{keywords:e.flex.keywords,patterns:e.flex.patterns.map(e=>e.toString())},deplacement:{keywords:e.deplacement.keywords,patterns:e.deplacement.patterns.map(e=>e.toString())}};S.updatePreferences({classificationRules:n}),re(),G("R√®gles r√©initialis√©es aux valeurs par d√©faut","info"),setTimeout(Z,3e3)}}t.g.goToPage=function(e){P=e,q(B)}})();